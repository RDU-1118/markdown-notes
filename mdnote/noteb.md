# Linux 作業系統實務 

## 2025/05/27
### 磁碟管理指令df與du
| 指令   | 功能說明            | 用途重點         |
| ---- | --------------- | ------------ |
| `df` | 查看整體檔案系統的磁碟使用狀況 | 瞭解每個掛載點的使用比例 |
| `du` | 查看特定資料夾或檔案的使用容量 | 找出佔空間大的目錄/檔案 |
#### df
| 選項   | 說明                   |
| ---- | -------------------- |
| `-h` | 以「可讀格式」（例如 MB/GB） 顯示 |
| `-T` | 顯示檔案系統類型             |

```bash 
#df
df [選項]
## 範例
df -h
----------------------------
Filesystem      Size  Used Avail Use% Mounted on
/dev/sda1       100G   60G   35G  64% /
tmpfs            16G     0   16G   0% /dev/shm
```
#### du 
| 選項     | 說明                     |
| ------ | ---------------------- |
| `-h`   | 以人類可讀格式顯示（例如 KB、MB）    |
| `-s`   | 顯示總結（summary），不遞迴列出子目錄 |
| `-a`   | 包含所有檔案（預設只列出目錄）        |
| `-d N` | 限制遞迴深度為 N 層            |


```bash 
# du 
du [選項] [目標目錄或檔案]
## 範例
du -sh /home/user
----------------------------
2.1G    /home/user
```
#### 上課舉例 
`du -a -BM /etc | sort -n -r | head -n 10`  
列出 /etc 目錄下佔空間最大的前 10 個檔案或目錄，並且單位是 MB

| 指令部分             | 功能說明                                                                   |
| ---------------- | ---------------------------------------------------------------------- |
| `du -a -BM /etc` | 列出 `/etc` 目錄下所有檔案與資料夾的磁碟使用量，單位為 MB。<br> `-a`：包含檔案<br> `-BM`：以「MB」為單位顯示 |
| `sort -n -r`     | 將結果按數值 **由大到小** 排序                                                     |
| `head -n 10`     | 顯示最前面（最大）的 10 筆資料                                                      |

#### hard link
- 只要把原本檔案刪除,hard link還是可以讀取原本檔案的內容
- 但在symbolic link (soft link)中把原本檔案刪除, soft link就無法讀取原本檔案內容
``` bash
ln {原始檔案} {新的硬連結名稱}
##範例
ln file.txt hardlink.txt
```
- 查看 inode
  ``` bash
  ls -li
  ------------------------
  123456 -rw-r--r-- 2 user user 1234 May 27 15:00 file.txt
  123456 -rw-r--r-- 2 user user 1234 May 27 15:00 hardlink.txt
  # 兩者 inode 編號相同 (123456)，代表是硬連結  
  ```

| 特性      | 說明                   |
| ------- | -------------------- |
| 是否共用資料  | 是，指向同一個 inode      |
| 是否共用檔名  | 否，有不同檔名            |
| 是否同步修改  | 是，修改一個會影響所有硬連結     |
| 是否能跨分割區 | 否，僅限於同一個檔案系統       |
| 是否可用於目錄 | 否（一般使用者無法對目錄使用硬連結） |
